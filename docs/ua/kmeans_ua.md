# Опис роботи скрипта

Цей скрипт виконує **вибірку на основі кластеризації методом K-Means** з оптимізацією гіперпараметрів за допомогою **Optuna**. Вибірка ґрунтується на відстані записів до центроїдів кластерів, де відбираються найбільш "віддалені" записи, що вважаються найбільш репрезентативними для свого кластеру.

## Як працює метод K-Means:

### Основи алгоритму K-Means:
- **K-Means** — це метод кластеризації, який розбиває дані на **k кластерів** на основі схожості між точками. Алгоритм ітеративно оновлює позиції центроїдів кластерів, щоб мінімізувати відстань між точками і їхніми центроїдами.
- Після завершення кластеризації кожна точка належить до кластера з найближчим центроїдом.
- **Гіперпараметри** (такі як кількість кластерів, кількість початкових ітерацій і максимальна кількість ітерацій) можуть впливати на якість кластеризації, тому вони оптимізуються за допомогою **Optuna**.

### Як це працює:

### Підготовка даних:
- Створюються копії оригінального та підготовленого наборів даних, щоб уникнути змін у вихідних даних.
- До набору даних додаються стовпці для зберігання відстаней до центроїдів та номерів кластерів.

### Оптимізація гіперпараметрів K-Means:
- За допомогою бібліотеки **Optuna** виконується оптимізація гіперпараметрів K-Means, таких як кількість кластерів, кількість початкових ітерацій та максимальна кількість ітерацій.
- Оптимізація базується на оцінці якості кластеризації за допомогою метрики **Calinski-Harabasz**, яка вимірює щільність та відокремленість кластерів.

### Відбір вибірки:
- Після оптимізації виконується кластеризація, і для кожного запису обчислюється відстань до центроїда його кластера.
- Для формування вибірки відбираються записи, що мають найбільші відстані до центроїдів, оскільки вони найкраще представляють свій кластер.

### Формування вибірки:
- Відібрані записи додаються у фінальну вибірку, і ці записи позначаються у стовпці `is_sample`.
- Якщо запитаний розмір вибірки перевищує кількість записів, виводиться попередження.

### Звіт про виконання:
- Формується підсумковий звіт про виконану вибірку, який включає кількість кластерів, параметри моделі, дату та час виконання, розмір вибірки і гіперпараметри, які були оптимізовані.

---

## Важливі моменти:

- **Оптимізація за допомогою Optuna**: Гіперпараметри K-Means оптимізуються за допомогою Optuna для покращення якості кластеризації.
- **Відбір на основі відстаней**: Записи відбираються на основі їхньої відстані до центроїдів, що дозволяє знайти найбільш репрезентативні зразки.
- **Можливість відтворення**: Використання випадкового зерна забезпечує можливість відтворення результатів кластеризації та вибірки.

---

## Можливі відхилення:

- **Мала кількість кластерів**: Якщо кількість кластерів занадто мала, це може призвести до поганої кластеризації, що вплине на якість вибірки.
- **Великі відстані можуть не бути ідеальними**: Вибірка на основі найбільших відстаней може не завжди відповідати меті вибірки для кожного конкретного випадку.

---

## На завершення:

- Цей скрипт використовує кластеризацію методом **K-Means** з оптимізацією гіперпараметрів за допомогою **Optuna**. Вибірка заснована на відстанях до центроїдів кластерів, що допомагає виділити найбільш репрезентативні записи.
